=== RUN   TestGenerateTokenPair
--- PASS: TestGenerateTokenPair (0.00s)
=== RUN   TestValidateAccessToken
=== RUN   TestValidateAccessToken/ValidToken
=== RUN   TestValidateAccessToken/EmptyToken
=== RUN   TestValidateAccessToken/InvalidToken
=== RUN   TestValidateAccessToken/WrongTokenType
--- PASS: TestValidateAccessToken (0.00s)
    --- PASS: TestValidateAccessToken/ValidToken (0.00s)
    --- PASS: TestValidateAccessToken/EmptyToken (0.00s)
    --- PASS: TestValidateAccessToken/InvalidToken (0.00s)
    --- PASS: TestValidateAccessToken/WrongTokenType (0.00s)
=== RUN   TestValidateRefreshToken
=== RUN   TestValidateRefreshToken/ValidToken
=== RUN   TestValidateRefreshToken/WrongTokenType
--- PASS: TestValidateRefreshToken (0.00s)
    --- PASS: TestValidateRefreshToken/ValidToken (0.00s)
    --- PASS: TestValidateRefreshToken/WrongTokenType (0.00s)
=== RUN   TestExtractTokenFromHeader
=== RUN   TestExtractTokenFromHeader/ValidHeader
=== RUN   TestExtractTokenFromHeader/EmptyHeader
=== RUN   TestExtractTokenFromHeader/InvalidFormat
=== RUN   TestExtractTokenFromHeader/MissingToken
=== RUN   TestExtractTokenFromHeader/TooShort
--- PASS: TestExtractTokenFromHeader (0.00s)
    --- PASS: TestExtractTokenFromHeader/ValidHeader (0.00s)
    --- PASS: TestExtractTokenFromHeader/EmptyHeader (0.00s)
    --- PASS: TestExtractTokenFromHeader/InvalidFormat (0.00s)
    --- PASS: TestExtractTokenFromHeader/MissingToken (0.00s)
    --- PASS: TestExtractTokenFromHeader/TooShort (0.00s)
=== RUN   TestTokenExpiration
=== RUN   TestTokenExpiration/TokenNotExpired
=== RUN   TestTokenExpiration/ExpiredToken
--- PASS: TestTokenExpiration (0.00s)
    --- PASS: TestTokenExpiration/TokenNotExpired (0.00s)
    --- PASS: TestTokenExpiration/ExpiredToken (0.00s)
=== RUN   TestGetTokenExpirationTime
=== RUN   TestGetTokenExpirationTime/access
=== RUN   TestGetTokenExpirationTime/refresh
=== RUN   TestGetTokenExpirationTime/unknown
--- PASS: TestGetTokenExpirationTime (0.00s)
    --- PASS: TestGetTokenExpirationTime/access (0.00s)
    --- PASS: TestGetTokenExpirationTime/refresh (0.00s)
    --- PASS: TestGetTokenExpirationTime/unknown (0.00s)
=== RUN   TestTokenSigning
=== RUN   TestTokenSigning/ConsistentSigning
    jwt_test.go:237: Warning: Tokens are identical, this might indicate timing issues
--- PASS: TestTokenSigning (0.01s)
    --- PASS: TestTokenSigning/ConsistentSigning (0.01s)
=== RUN   TestCustomClaims
--- PASS: TestCustomClaims (0.00s)
=== RUN   TestEdgeCases
=== RUN   TestEdgeCases/NilUser
=== RUN   TestEdgeCases/ZeroUser
--- PASS: TestEdgeCases (0.00s)
    --- PASS: TestEdgeCases/NilUser (0.00s)
    --- PASS: TestEdgeCases/ZeroUser (0.00s)
=== RUN   TestAuthMiddleware
=== RUN   TestAuthMiddleware/ValidToken
2025/09/07 21:39:06 [AUTH] User 1 (testuser) accessing GET /test
=== RUN   TestAuthMiddleware/MissingAuthHeader
=== RUN   TestAuthMiddleware/InvalidAuthHeader
=== RUN   TestAuthMiddleware/ExpiredToken
--- PASS: TestAuthMiddleware (0.00s)
    --- PASS: TestAuthMiddleware/ValidToken (0.00s)
    --- PASS: TestAuthMiddleware/MissingAuthHeader (0.00s)
    --- PASS: TestAuthMiddleware/InvalidAuthHeader (0.00s)
    --- PASS: TestAuthMiddleware/ExpiredToken (0.00s)
=== RUN   TestOptionalAuthMiddleware
=== RUN   TestOptionalAuthMiddleware/WithValidToken
=== RUN   TestOptionalAuthMiddleware/WithoutToken
=== RUN   TestOptionalAuthMiddleware/WithInvalidToken
--- PASS: TestOptionalAuthMiddleware (0.00s)
    --- PASS: TestOptionalAuthMiddleware/WithValidToken (0.00s)
    --- PASS: TestOptionalAuthMiddleware/WithoutToken (0.00s)
    --- PASS: TestOptionalAuthMiddleware/WithInvalidToken (0.00s)
=== RUN   TestCORSMiddleware
=== RUN   TestCORSMiddleware/AllowedOrigin
=== RUN   TestCORSMiddleware/UnallowedOrigin
=== RUN   TestCORSMiddleware/NoOriginHeader
=== RUN   TestCORSMiddleware/OptionsRequest
--- PASS: TestCORSMiddleware (0.00s)
    --- PASS: TestCORSMiddleware/AllowedOrigin (0.00s)
    --- PASS: TestCORSMiddleware/UnallowedOrigin (0.00s)
    --- PASS: TestCORSMiddleware/NoOriginHeader (0.00s)
    --- PASS: TestCORSMiddleware/OptionsRequest (0.00s)
=== RUN   TestRateLimitMiddleware
=== RUN   TestRateLimitMiddleware/WithinLimit
=== RUN   TestRateLimitMiddleware/ExceedsLimit
=== RUN   TestRateLimitMiddleware/DifferentIPs
    middleware_test.go:269: 
        	Error Trace:	/Users/lutao/GolandProjects/jobView/backend/tests/auth/middleware_test.go:269
        	Error:      	Not equal: 
        	            	expected: 200
        	            	actual  : 429
        	Test:       	TestRateLimitMiddleware/DifferentIPs
--- FAIL: TestRateLimitMiddleware (0.00s)
    --- PASS: TestRateLimitMiddleware/WithinLimit (0.00s)
    --- PASS: TestRateLimitMiddleware/ExceedsLimit (0.00s)
    --- FAIL: TestRateLimitMiddleware/DifferentIPs (0.00s)
=== RUN   TestSecurityHeadersMiddleware
--- PASS: TestSecurityHeadersMiddleware (0.00s)
=== RUN   TestLoggingMiddleware
2025/09/07 21:39:06 [HTTP] GET /test - 200 - 875ns - 127.0.0.1
--- PASS: TestLoggingMiddleware (0.00s)
=== RUN   TestGetUserFromContext
=== RUN   TestGetUserFromContext/UserInContext
=== RUN   TestGetUserFromContext/NoUserInContext
--- PASS: TestGetUserFromContext (0.00s)
    --- PASS: TestGetUserFromContext/UserInContext (0.00s)
    --- PASS: TestGetUserFromContext/NoUserInContext (0.00s)
=== RUN   TestGetUserIDFromContext
=== RUN   TestGetUserIDFromContext/UserIDInContext
=== RUN   TestGetUserIDFromContext/NoUserIDInContext
--- PASS: TestGetUserIDFromContext (0.00s)
    --- PASS: TestGetUserIDFromContext/UserIDInContext (0.00s)
    --- PASS: TestGetUserIDFromContext/NoUserIDInContext (0.00s)
=== RUN   TestRequireOwnership
=== RUN   TestRequireOwnership/SameUser
=== RUN   TestRequireOwnership/DifferentUser
=== RUN   TestRequireOwnership/ZeroIDs
--- PASS: TestRequireOwnership (0.00s)
    --- PASS: TestRequireOwnership/SameUser (0.00s)
    --- PASS: TestRequireOwnership/DifferentUser (0.00s)
    --- PASS: TestRequireOwnership/ZeroIDs (0.00s)
=== RUN   TestMiddlewareChaining
2025/09/07 21:39:06 [AUTH] User 1 (testuser) accessing GET /test
2025/09/07 21:39:06 [HTTP] GET /test - 200 - 19.416Âµs - 192.0.2.1
--- PASS: TestMiddlewareChaining (0.00s)
FAIL
coverage: [no statements]
FAIL	jobView-backend/tests/auth	0.204s
FAIL
